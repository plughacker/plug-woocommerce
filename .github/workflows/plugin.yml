name: APP

on: [push]

jobs:
   tests:
     runs-on: ubuntu-latest
     steps:
       - name: Checkout
         uses: actions/checkout@v2
       - name: Composer
         uses: php-actions/composer@v5
       - name: Running tests
         uses: php-actions/phpunit@v3
   build:
     runs-on: ubuntu-latest
     needs: [tests]     

     steps:
       - uses: actions/checkout@v2
       - uses: actions/setup-node@v1    
         with:
           node-version: 8
       - run: npm install
       - run: npm run build 
       - uses: montudor/action-zip@v1
         with:
           args: unzip -qq woocommerce-plug-payments.zip -d src/plugins/woocommerce-plug-payments      
       - uses: actions/upload-artifact@v1
         with:
           name: woocommerce-plug-payments
           path: ${{ github.workspace }}/woocommerce-plug-payments.zip                     